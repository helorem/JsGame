<html>
	<head>
		<script type="text/javascript" src="functions.js"></script>
		<script type="text/javascript" src="Sprite.js"></script>
		<script type="text/javascript" src="GraphicItem.js"></script>
		<script type="text/javascript" src="PhysicItem.js"></script>
		<script type="text/javascript" src="Creature.js"></script>
		<script type="text/javascript" src="WallManager.js"></script>
		<script type="text/javascript" src="Screen.js"></script>
		<script type="text/javascript" src="ControlManager.js"></script>
		<script type="text/javascript">
			var MOVE_SPEED = 25;
			var MOVE_STEP = 3;
			var DIRECTIONS = ["N", "NE", "E", "SE", "S", "NW", "W", "SW"];
			var RATIO_DIRECTION = [(Math.sin(Math.radians(22.5)) / Math.cos(Math.radians(22.5))),
								   (Math.sin(Math.radians(67.5)) / Math.cos(Math.radians(67.5)))];

			var g_images = {
				"images/scrub.png" : {"img" : null, "frames" : null, "is_loaded" : false, "w" : 78, "h" : 114, "total_w" : 624, "total_h" : 1368, "orientation" : "v", "selection_size" : 15, "animation" : [
					12, 12, 12, 12, 12, 12, 12, 12]},
				"images/steppe.png" : {"img" : null, "frames" : null, "is_loaded" : false, "w" : 32, "h" : 32, "total_w" : 320, "total_h" : 992, "orientation" : "h", "selection_size" : 0, "animation" : [
					16,	4, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 16, 16, 16, 16, 20, 4, 5, 16]}
			};

			function start()
			{
				var canvas = document.getElementById("screen");
				var ctx = canvas.getContext("2d");
				Screen.get().init(ctx, "images/steppe.png", canvas.width, canvas.height);
				ControlManager.get().init(canvas, document.getElementById("action"));

				var item = new Creature(50, 50, "images/scrub.png");
				Screen.get().addItem(item);

				WallManager.get().addWall(11, 150, 50, 300, 50);
				WallManager.get().addWall(11, 160, 50, 160, 100);

				Screen.get().looping = true;
				Screen.get().loop();
			}

			function action1()
			{
				//Screen.get().items[0].turn(1);

				var item = Screen.get().items[0];
				var item2 = Screen.get().items[1];
				item.isColliding(item2);
			}
		</script>
	</head>
	<body>
		<canvas id="screen" width=1024 height=500 style="border : 1px solid #000000;"></canvas>
		<br />
		<select id="action">
			<option value="default">Default</option>
			<option value="create_creature">Create Creature</option>
			<option value="create_wall1">Create Wall 1</option>
			<option value="create_wall2">Create Wall 2</option>
		</select>
		<br />
		<button onClick="action1()">action1</button>
		<script type="text/javascript">
			function on_images_loaded()
			{
				var res = true;
				for (var src in g_images)
				{
					if (g_images[src]["img"] == this)
					{
						g_images[src]["is_loaded"] = true;
						loadImageData(src);
						g_images[src]["img"] = null;
					}
					else if (!g_images[src]["is_loaded"])
					{
						res = false;
					}
				}

				if (res)
				{
					start();
				}
			}

			for (var src in g_images)
			{
				var img = new Image();
				img.onload = on_images_loaded;
				img.src = src;
				g_images[src]["img"] = img;
			}
		</script>
	</body>
</html>
